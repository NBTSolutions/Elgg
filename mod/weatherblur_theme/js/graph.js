
// ../js/namespace.js
wb={graph:{model:{},assets:{},constants:{}}};

// ../js/model/Constants.js
moment.defaultFormat="YYYY-MM-DD",wb.graph.aggregatorUrl="localhost";

// ../js/component/GraphView.js
enyo.kind({name:"wb.GraphView",published:{marginTop:20,marginBottom:80,marginLeft:80,marginRight:80,yAxisOffset:15,pointRadius:60,selectedPointRadius:72},events:{onError:""},handlers:{onNewData:"handleNewData"},components:[{name:"dataPopup",kind:"nbt.DataPopup"}],rendered:function(){this.inherited(arguments)},getPlotWidth:function(){var t=this.hasNode();if(t){var a=this.getBounds();return a.width-this.marginLeft-this.marginRight}return 0},getPlotHeight:function(){var t=this.hasNode();if(t){var a=this.getBounds();return a.height-this.marginTop-this.marginBottom}return 0},handleNewData:function(t,a){a.data&&this.redrawGraph(a.data)},drawEmptyGraph:function(){var t=this.startPlotting();this.drawXAxis(t,[moment().startOf("day").toDate(),moment().endOf("day").toDate()]),this.drawYAxis(t,"left",[8,88],"Air Temperature"),this.drawYAxis(t,"right",[0,5],"24 Hour Rainfall")},redrawGraph:function(t){if(!t.dates||!t.measurements||!t.measuredData)return this.doError({message:"Missing data, graph cannot be drawn, try again later"}),void 0;var a=t.measuredData,e=this.startPlotting(),i=[t.dates.start,t.dates.end],s=this.drawXAxis(e,i);x=s;var n=["left","right"],r=enyo.bind(this,this.mouseOver),o=enyo.bind(this,this.mouseOut),d=0;_.each(a,enyo.bind(this,function(t,a){if(t.domain&&t.domain.length>0){var i=n[d%2];d++;var h=t.data,m=this.cleanDomain(t.domain),l=this.drawYAxis(e,i,m,t.title);y=l;var u=e.selectAll(a).data(h).enter().append("path").attr("class","side_"+i).attr("transform","translate(-100,-100)").attr("d",d3.svg.symbol().type(function(t){return t.shape}).size(2*this.pointRadius));u.transition().duration(500).each("end",function(){d3.select(this).on("mouseover",function(a,e){var i=d3.select(this);r(a,e,i,t.title,t.unit)}).on("mouseout",function(){o(this)})}).attr("transform",function(t){return"translate("+s(new Date(t.timestamp))+","+l(t.value)+")"})}}))},startPlotting:function(){d3.select("svg#wb-graph").remove();var t=d3.select("#"+this.id).append("svg:svg").attr("id","wb-graph").attr("width",this.getPlotWidth()+this.marginLeft+this.marginRight).attr("height",this.getPlotHeight()+this.marginTop+this.marginBottom).append("svg:g").attr("transform","translate("+this.marginRight+","+this.marginTop+")");return this.plot=t,t},drawXAxis:function(t,a){var e=d3.time.scale().domain(a).range([0,this.getPlotWidth()]);this.dateScale=e;var i=enyo.bind(this,this.centerDateLabels),s=d3.time.hours;moment(a[1]).isAfter(moment(a[0]).add("days",60))?(this.scaleOffset=d3.time.month,s=d3.time.months):moment(a[1]).isAfter(moment(a[0]).add("days",35))?(this.scaleOffset=d3.time.week,s=d3.time.weeks):moment(a[1]).isAfter(moment(a[0]).add("days",1))?(this.scaleOffset=d3.time.day,s=d3.time.days):this.scaleOffset=d3.time.hour;var n=d3.svg.axis().scale(e).orient("bottom").ticks(s,1).tickPadding(0).tickSubdivide(0).tickSize(-this.getPlotHeight());return s==d3.time.months&&n.tickFormat(d3.time.format("%b")),t.append("svg:g").attr("class","x_axis").attr("transform","translate(0, "+this.getPlotHeight()+")").call(n).call(i).selectAll("text").style("text-anchor","end").attr("dx","-.3em").attr("dy","0.35em"),e},drawYAxis:function(t,a,e,i){var s=d3.scale.linear().domain(e).range([this.getPlotHeight(),0]),n=d3.svg.axis().scale(s).ticks(6).orient(a),r=-this.yAxisOffset,o=r-30,d=-90;return"right"==a&&(r=this.yAxisOffset+this.getPlotWidth(),o=r+30,d=90),t.append("svg:g").attr("class","y_axis axis_"+a).attr("transform","translate("+r+", 0)").call(n),t.append("text").attr("class","y_label_"+a).attr("text-anchor","middle").attr("transform","translate("+o+", "+this.getPlotHeight()/2+") rotate("+d+")").text(i),s},mouseOver:function(t,a,e,i,s){var n=parseFloat(e.attr("cx"))+this.marginRight+20,r=parseFloat(e.attr("cy"));d3.time.format("%c");var o=this.$.dataPopup;o.setValue(t.value),o.setTitle(i),o.setUnitLabel(s),o.setMoment(t.timestamp),o.showAtPosition({left:n,top:r}),e.transition().duration(200).attr("r",this.selectedPointRadius)},mouseOut:function(t){this.$.dataPopup.hide(),d3.select(t).transition().duration(200).attr("r",this.pointRadius)},formatYData:function(t){var a={};return _.each(t.data,enyo.bind(this,function(t){t.measurements&&_.each(t.measurements,enyo.bind(this,function(e){var i=e.phenomenon.name;a[i]&&(a[i].title=a[i].title||e.phenomenon.description,a[i].unit=a[i].unit||e.phenomenon.unit.name,a[i].data=a[i].data||[],a[i].data.push({timestamp:t.timestamp,value:e.value}),a[i].domain=a[i].domain||[],a[i].domain.push(e.value))}))})),a},getAxisDates:function(t){var a=moment(t.start),e=moment(t.end),t=[];if(e.isAfter(moment(a).add("days",2)))for(;a.isBefore(e);)t.length>0?t[1]=moment(a).endOf("day").toDate():t.push(moment(a).startOf("day").toDate()),a.add("days",1);return t},centerDateLabels:function(t){t.selectAll("text").attr("transform","translate("+this.dayToPixels()/2+",0) rotate(-90)")},dayToPixels:function(){var t=new Date;return this.dateScale(this.scaleOffset.offset(t,1))-this.dateScale(t)},cleanDomain:function(t){var a=1*d3.min(t),e=1*d3.max(t);if(100==e&&a>=0)return[a,e];var i=.1*(e-a);return 0==i&&(i=.1*a),a-=i,e+=i,[a,e]}});

// ../js/component/GraphControls.js
enyo.kind({name:"wb.GraphControls",published:{from:null,phenomena:null,measurements:[],maxMeasurements:2,users:["Me"],maxUsers:2,startMoment:moment().subtract("days",1).startOf("day"),endMoment:moment().subtract("days",1).endOf("day")},events:{onError:"",onFromChanged:"",onRequestData:""},components:[{classes:"row",components:[{classes:"parameter-block",components:[{classes:"display",content:"From:"},{name:"fromDisplay",id:"from-display",classes:"choice-display",ontap:"showPersonPicker",content:'<i class="icon-circle"></i> Me',allowHtml:!0},{tag:"i",ontap:"showPersonPicker",classes:"icon-group elgg-button elgg-button-action"}]},{classes:"parameter-block",name:"startDate",components:[{classes:"display",content:"Start Date:"},{name:"startDateDisplay",classes:"choice-display",ontap:"showCalendar",content:""},{tag:"i",ontap:"showCalendar",classes:"icon-calendar elgg-button elgg-button-action"},{kind:"wb.NewDatePickCalendar",name:"startDateCalendar",floating:!1,centered:!1,showDatePicker:!1,onSelect:"dateSelected"}]},{classes:"parameter-block",name:"endDate",components:[{classes:"display",content:"End Date:"},{name:"endDateDisplay",classes:"choice-display",ontap:"showCalendar",content:""},{tag:"i",ontap:"showCalendar",classes:"icon-calendar elgg-button elgg-button-action"},{kind:"wb.NewDatePickCalendar",name:"endDateCalendar",floating:!1,centered:!1,showDatePicker:!1,onSelect:"dateSelected"}]}]},{classes:"row measure",components:[{tag:"h4",content:"Choose up to 2 Measures for Display"},{name:"measureBlock",classes:"measure-block"}]},{name:"toolbar",components:[{kind:"enyo.Button",classes:"elgg-button elgg-button-submit",ontap:"showGraph",content:"Show Graph"}]},{name:"people",id:"graph_people",showing:!1,components:[{tag:"h3",content:"Whose Observations Do You Want To See?"},{name:"me",kind:"nbt.Checkbox",text:"Use My Own Observations",value:"Me",checked:!0,ontap:"userToggled"},{name:"any",kind:"nbt.Checkbox",text:"Use Anyone's Observations",value:"Anyone",checked:!1,ontap:"userToggled"},{id:"peoplepicker_placeholder"},{kind:"enyo.Button",classes:"elgg-button elgg-button-action",content:"Okay",ontap:"peopleSelected"}]}],create:function(){this.inherited(arguments);var t=new wb.api.PhenomenonCollection;t&&t.fetch&&t.fetch({query:"byUomType",data:{type:"scalar"},success:enyo.bind(this,"setPhenomena")}),this.$.startDateCalendar.setDate(this.startMoment.toDate(),!0),this.$.startDateDisplay.setContent(this.startMoment.format()),this.$.endDateCalendar.setDate(this.endMoment.toDate(),!0),this.$.endDateDisplay.setContent(this.endMoment.format())},phenomenaChanged:function(){this.phenomena=_(this.phenomena.sortBy(function(t){return t.get("name")})),this.phenomena.each(function(t){"scalar"==t.get("unit").get("type")&&this.$.measureBlock.createComponent({kind:"nbt.Checkbox",text:t.get("description"),value:t.get("name"),checked:!1,ontap:"measurementToggled",owner:this})},this),this.$.measureBlock.render()},measurementToggled:function(t){this.measurements=this.toggleTwo(this.measurements,this.maxMeasurements,t.checked,t.value),this.measureTitles=this.measureTitles||{},this.measureTitles[t.value]=t.text;var e=this.$.measureBlock.getControls();_.each(e,enyo.bind(this,function(t){"nbt.Checkbox"!=t.kind||_.contains(this.measurements,t.getValue())||t.setChecked(!1)}))},toggleTwo:function(t,e,a,s){return t=t||[],a?_(t).contains(s)||t.push(s):t=_(t).without(s),t.length>e&&(t=_(t).last(e)),t},userToggled:function(t){if(this.users=this.toggleTwo(this.users,this.maxUsers,t.checked,t.value),this.$.me.setChecked(_(this.users).contains("Me")),this.$.any.setChecked(_(this.users).contains("Anyone")),$){var e=this.users;$(".friends-picker-container input[type=checkbox]").each(function(){this.checked=_(e).contains(this.value)?"checked":""})}},showPersonPicker:function(){if($){var t=$("#tab_graphing > #peoplepicker");1==t.length&&$("#peoplepicker_placeholder").replaceWith(t)}this.$.people.show()},showCalendar:function(t){var e,a=t.parent.name,s=null;"startDate"==a?(e=this.$.startDateCalendar,s=this.$.endDateCalendar):"endDate"==a&&(e=this.$.endDateCalendar,s=this.$.startDateCalendar),e&&(e.showing?e.hide():e.show()),s&&s.hide()},dateSelected:function(t){if("startDateCalendar"==t.name){var e=moment(t.value).startOf("day");t.value=e.toDate(),this.$.startDateDisplay.setContent(e.format("YYYY-MM-DD")),this.startMoment=e;var a=moment(this.$.endDateCalendar.getValue());if(a.isBefore(e))a=moment(e).endOf("day"),this.$.endDateCalendar.setDate(a.toDate());else{var s=moment(e).add("months",12).endOf("day");moment(this.$.endDateCalendar.getValue()).isAfter(s)&&this.$.endDateCalendar.setDate(s.toDate())}this.$.startDateCalendar.hide()}else if("endDateCalendar"==t.name){var a=moment(t.value).endOf("day");t.value=a.toDate(),this.$.endDateDisplay.setContent(a.format("YYYY-MM-DD")),this.endMoment=a;var e=moment(this.$.startDateCalendar.getValue());if(e.isAfter(a))e=moment(a).startOf("day"),this.$.startDateCalendar.setDate(e.toDate());else{var n=moment(a).subtract("months",12).startOf("day");e.isBefore(n)&&this.$.startDateCalendar.setDate(n.toDate())}this.$.endDateCalendar.hide()}},showGraph:function(){var t=this.userIds;if(t||(t=[window.uid||!1],this.userNames=this.userNames||{},this.userNames[window.uid]="You"),!this.measurements||0==this.measurements.length)return this.doError({message:"Please select at least 1 measure to be shown"}),void 0;var e={inDateRange:{begin:moment(this.startMoment).format(),end:moment(this.endMoment).format()},withPhenomena:this.measurements};this.doRequestData({data:e,users:t})},peopleSelected:function(){0==this.users.length&&(this.users=["Me"]),this.userNames={};for(var t=["icon-circle","icon-sign-blank"],e=[],a=[],s=0;this.users.length>s;s++){var n='<i class="'+t[s]+'"></i>',i=this.users[s];if("Me"==i)a.push(window.uid),this.userNames[window.uid]="You";else if("Anyone"==i)a.push(!1);else{a.push(i);var o=$(".friends-picker-container input[value="+i+"]");o.length>0&&(this.userNames[i]=o.parent().siblings("td[guid="+i+"]").last().html().trim(),i=this.userNames[i])}e.push(n+i)}this.$.fromDisplay.setContent(e.join(", ")),this.userIds=a,this.$.people.hide()}});

// ../js/component/Checkbox.js
enyo.kind({name:"nbt.Checkbox",classes:"nbt-checkbox",published:{text:"",value:"",checked:!0},events:{ontap:""},components:[{tag:"i",name:"checkbox",classes:"icon-check-empty",ontap:"tapped"},{name:"text",ontap:"tapped"}],create:function(){this.inherited(arguments),this.$.text.setContent(this.text),this.checkedChanged()},tapped:function(){this.setChecked(!this.checked)},checkedChanged:function(){var t=this.$.checkbox;this.checked?(t.removeClass("icon-check-empty"),t.addClass("icon-check")):(t.addClass("icon-check-empty"),t.removeClass("icon-check"))}});

// ../js/component/NewDatePickCalendar.js
enyo.kind({kind:"onyx.Popup",name:"wb.NewDatePickCalendar",published:{showDatePicker:!0,value:moment(),monthDisplayFormat:"MMMM"},events:{onSelect:""},centered:!0,floating:!0,scrim:!0,autoDismiss:!0,modal:!0,classes:"calendar-popup",components:[{name:"header",components:[{tag:"i",classes:"icon-circle-arrow-left",ontap:"prevMonth"},{name:"monthDisplay",classes:"month",content:"",showing:!1},{kind:"onyx.DatePicker",onSelect:"doPickerChanged"},{tag:"i",classes:"icon-circle-arrow-right",ontap:"nextMonth"}]},{kind:"CalendarSelector",onDaySet:"doCalendarChanged",onSelect:"selectDate"},{kind:"onyx.Button",content:" Cancel",classes:"icon-remove",ontap:"hide"},{kind:"onyx.Button",content:" Done",classes:"icon-ok",ontap:"doSaveAndHide"}],create:function(){this.inherited(arguments),this.showDatePicker||(this.$.button.hide(),this.$.button2.hide(),this.$.datePicker.hide(),this.$.monthDisplay.show(),this.updateMonthDisplay())},updateMonthDisplay:function(t){t||(t=this.value),this.$.monthDisplay.setContent(moment(t).format(this.monthDisplayFormat))},doCalendarChanged:function(t,e){var a=moment(t.getValue()),s=moment(e.control.getValue());a.isSame(s,"day")&&(_.each(t.getDays(),function(t){t.addRemoveClass("day-selected",!1)},this),e.control.addRemoveClass("day-selected",!0),this.showDatePicker&&this.$.datePicker.setValue(a.toDate()))},setDate:function(t,e){e?(this.value=t,this.$.calendarSelector.setValue(t),this.$.datePicker.setValue(t)):this.$.calendarSelector.calTap({value:t})},selectDate:function(t,e){return this.$.datePicker.setValue(e.value),this.showDatePicker||this.doSaveAndHide(),!0},doPickerChanged:function(t,e){this.$.calendarSelector.setValue(e.value)},nextMonth:function(){if(this.showDatePicker)this.$.calendarSelector.nextMonth();else{var t=moment(this.$.calendarSelector.getValue()).add("months",1);this.$.calendarSelector.setValue(t.toDate()),this.$.monthDisplay.setContent(t.format(this.monthDisplayFormat))}},prevMonth:function(){if(this.showDatePicker)this.$.calendarSelector.prevMonth();else{var t=moment(this.$.calendarSelector.getValue()).subtract("months",1);this.$.calendarSelector.setValue(t.toDate()),this.$.monthDisplay.setContent(t.format(this.monthDisplayFormat))}},doSaveAndHide:function(){this.value=this.$.datePicker.getValue(),this.doSelect({value:this.value}),this.hide()}});

// ../js/component/NestedPopup.js
enyo.kind({name:"nbt.NestedPopup",kind:"onyx.Popup",published:{nestObject:null},handlers:{onPopup:"doPopup"},doPopup:function(){var t=this.nestObject||this.parent;if(t.kindName&&(t=t.hasNode()),this.show(),t){var e=enyo.dom.getBounds(t),a=this.getBounds(),s={left:e.left+e.width/2-a.width/2,top:e.top+e.height/2-a.height/2};this.targetPosition=s,this.updatePosition()}}});

// ../js/component/ModalMessagePopup.js
enyo.kind({name:"nbt.ModalMessagePopup",kind:"nbt.NestedPopup",events:{onOk:"",onCancel:""},components:[{name:"message",allowHtml:!0,content:"Message"},{kind:"enyo.Button",name:"okButton",classes:"elgg-button elgg-button-action",ontap:"popupOk",components:[{tag:"i",classes:"icon-ok"},{content:"Ok"}]},{kind:"enyo.Button",name:"cancelButton",classes:"elgg-button elgg-button-action",ontap:"popupCancel",showing:!1,components:[{tag:"i",classes:"icon-ban-circle"},{content:"Cancel"}]}],showMessage:function(t,e){e=e||{},this.$.message.setContent(t),e.hideOk&&this.$.okButton.hide(),e.cancel&&this.$.cancelButton.show(),this.doPopup()},popupOk:function(t){t.owner.doOk(),t.owner.hide()},popupCancel:function(t){t.owner.doCancel(),t.owner.hide()}});

// ../js/component/DataPopup.js
enyo.kind({name:"nbt.DataPopup",kind:"enyo.Popup",classes:"data_popup",published:{title:"",value:"",unitLabel:"",moment:""},components:[{name:"title"},{classes:"value",components:[{name:"value"},{name:"unit"}]},{name:"date"}],titleChanged:function(){this.$.title.setContent(this.title)},valueChanged:function(){this.$.value.setContent(this.value)},unitLabelChanged:function(){var t=this.convertUnitLabel(this.unitLabel);this.$.unit.setContent(t)},momentChanged:function(){this.$.date.setContent(moment(this.moment).format("ddd, MMM DD YYYY, h:mm:ss a"))},convertUnitLabel:function(t){return"FAHRENHEIT"==t.toUpperCase()?"\u00b0 F":"INCHES"==t.toUpperCase()?'"':t}});

// ../js/App.js
enyo.kind({name:"wb.Graph",published:{data:null,queryUrl:wb.graph.aggregatorUrl+"/observation/query",observations:null,retrievedMeasures:0},components:[{name:"header"},{kind:"wb.GraphView",onError:"showErrorMessage"},{kind:"wb.GraphControls",onRequestData:"doRequestData",onError:"showErrorMessage"},{name:"footer"},{name:"popup",kind:"nbt.ModalMessagePopup"},{kind:"nbt.NestedPopup",name:"spinner",id:"graph-spinner",components:[{tag:"i",classes:"icon-spinner icon-spin"}]}],showErrorMessage:function(e,t){t.message&&enyo.job("showmsg",enyo.bind(this,function(){this.$.popup.showMessage(t.message)}),500)},rendered:function(){this.inherited(arguments),this.$.popup.nestObject=this.$.graphView,this.$.spinner.nestObject=this.$.graphView},dataChanged:function(){this.waterfall("onNewData",{data:this.data})},doRequestData:function(e,t){this.showSpinner(),Backbone.Relational.store.reset(),(new wb.api.ObservationCollection).fetch({data:t.data,success:enyo.bind(this,function(e){if(0==e.length)this.hideSpinner(),this.showErrorMessage(this,{message:"No measurements matched your request.<br/>Please try again."});else{var a=e.groupBy(function(e){return e.get("observer").get("elggId")}),s=new wb.api.ObservationCollection;this.userIds=t.users;for(var n=0;t.users.length>n;n++)if(t.users[n]){var i=a[t.users[n]];if(!i||0==i.length)return this.hideSpinner(),this.showErrorMessage(this,{message:"No results matched for "+this.$.graphControls.userNames[t.users[n]]+".<br/>Please try again."}),void 0;s.add(i)}else s=e;this.setObservations(s)}})})},observationsChanged:function(){this.measuredData={};for(var e=0;this.$.graphControls.measurements.length>e;e++)this.measuredData[this.$.graphControls.measurements[e]]={};this.observations&&this.observations.length>0&&(this.retrievedMeasures=0,this.observations.each(enyo.bind(this,function(e){e.set({measurements:e.id});var t=e.get("observer").get("elggId"),a="circle";(t==this.userIds[1]||this.userIds[1]===!1)&&(a="square"),e.fetchRelated("measurements",{success:enyo.bind(this,function(t){if(t.length>0&&t.each(enyo.bind(this,function(t){if(t.get("class")&&"wb.api.Measurement"==t.get("class")){var s=t.get("phenomenon");if(s&&this.measuredData[s.get("name")]){var n=s.get("name");this.measuredData[n].title=this.measuredData[n].title||s.get("description"),this.measuredData[n].unit=this.measuredData[n].unit||s.get("unit").get("name"),this.measuredData[n].data=this.measuredData[n].data||[],this.measuredData[n].data.push({timestamp:e.get("timestamp"),value:t.get("value"),shape:a}),this.measuredData[n].domain=this.measuredData[n].domain||[],this.measuredData[n].domain.push(new Number(t.get("value")))}}})),this.retrievedMeasures++,this.retrievedMeasures==this.observations.length){this.hideSpinner();for(var s=[],n=0;this.$.graphControls.measurements.length>n;n++){var i=this.$.graphControls.measurements[n];0==_.keys(this.measuredData[i]).length&&s.push(this.$.graphControls.measureTitles[i])}s.length>0&&this.$.popup.showMessage("Sorry, we could find no data for<br/>"+s.join(" or ")+"<br/>that matched your request"),this.setData({dates:{start:this.$.graphControls.startMoment,end:this.$.graphControls.endMoment},measurements:this.$.graphControls.measurements,measuredData:this.measuredData})}})})})))},showSpinner:function(){this.$.spinner.doPopup()},hideSpinner:function(){this.$.spinner.hide()}});

// machiapps/CalendarSelector/CalendarSelector.js
enyo.kind({name:"CalendarSelector",classes:"enyo-unselectable",published:{dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],value:new Date,dayColorDefault:"LightSlateGray",dayColorSelected:"Gold",dayColorToday:"GoldenRod",dayColorOtherMonth:"Silver",numberColorThisMonth:"#202020",numberColorOtherMonth:"dimgrey"},events:{onSelect:"",onDaySet:""},components:[{name:"day_names",classes:"top-day-box"},{fit:!0,name:"calVBox",kind:"CalMonth",style:"height: auto;"}],create:function(){this.inherited(arguments);for(var e=0;7>e;e++)this.$.day_names.createComponent({content:this.dayNames[e]})},rendered:function(){this.inherited(arguments),this.updateCalendar()},updateCalendar:function(){this.dayArray=[],this.getDays(),this.fillData()},fillData:function(){for(var e=this.$.calVBox.getControls(),t=0,a=0;e.length>a;a++)for(var n=e[a].getControls(),s=0;n.length>s;s++){n[s].setValue(this.dayArray[t]),n[s].setClassAttribute("");var i=this.getRelativeClass(this.dayArray[t]);n[s].addClass(i),t++,this.doDaySet({control:n[s]})}},getRelativeClass:function(e){if(e.getMonth()<this.value.getMonth())return"prev-month";if(e.getMonth()>this.value.getMonth())return"next-month";var t=new Date;return t.getFullYear()==e.getFullYear()&&t.getDate()==e.getDate()&&t.getMonth()==e.getMonth()?"today":"day"},getColors:function(e){var t=this.dayColorDefault,a=this.numberColorThisMonth,n=(new Date).getDate(),s=(new Date).getMonth(),i=(new Date).getFullYear();return e.getMonth()!=this.value.getMonth()?(t=this.dayColorOtherMonth,a=this.numberColorOtherMonth):this.value.getFullYear()==e.getFullYear()&&this.value.getDate()==e.getDate()&&this.value.getMonth()==e.getMonth()?t=this.dayColorSelected:i==e.getFullYear()&&n==e.getDate()&&s==e.getMonth()&&(t=this.dayColorToday),[t,a]},getDays:function(){var e=new Date(this.value);e.setDate(1);var t=e.getDay(),a=new Date(e);a.setDate(0);var n=a.getDate(),s=new Date(e);s.setMonth(e.getMonth()+1),s.setDate(0);var o=s.getDate(),r=n-t+1;for(i=0;t>i;i++)this.dayArray.push(new Date(a.getFullYear(),a.getMonth(),r,12,0,0)),r++;for(r=1;o>=r;)this.dayArray.push(new Date(s.getFullYear(),s.getMonth(),r,12,0,0)),r++;for(r=1,s.setDate(s.getDate()+1);42>this.dayArray.length;)this.dayArray.push(new Date(s.getFullYear(),s.getMonth(),r,12,0,0)),r++},calTap:function(e){this.value=e.value,this.updateCalendar(),this.doSelect({value:this.value})},setValue:function(e){this.value=new Date(e),this.updateCalendar()},nextMonth:function(){var e=this.value.getDate();this.value.setMonth(this.value.getMonth()+1),e!=this.value.getDate()&&this.value.setDate(0),this.updateCalendar(),this.doSelect({value:this.value})},prevMonth:function(){var e=this.value.getDate();this.value.setMonth(this.value.getMonth()-1),e!=this.value.getDate()&&this.value.setDate(0),this.updateCalendar(),this.doSelect({value:this.value})}}),enyo.kind({name:"CalDay",classes:"day-container",published:{value:{}},events:{onDayPicked:""},handlers:{ontap:"tapMe"},valueChanged:function(){this.setContent(this.value.getDate())},setValue:function(e){this.value=e,this.valueChanged()},tapMe:function(){return this.owner.owner.owner.calTap({value:this.value}),this.doDayPicked({day:this}),!0}}),enyo.kind({name:"CalWeek",classes:"onyx-toolbar-inline week-container",defaultKind:"CalDay",components:[{},{},{},{},{},{},{}]}),enyo.kind({name:"CalMonth",defaultKind:"CalWeek",components:[{},{},{},{},{},{}]});
